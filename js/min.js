const INPUT_SIZE=28,SCALE=8;function resizeInput(e){var t=INPUT_SIZE*SCALE;e.width=t,e.height=t}function normalize(e,t){var n=bound(e,{x:100,y:100},4/INPUT_SIZE*100),a=renderIntermediate(100,n),o=centerOfMass(a),r=50-o.x,s=50-o.y;for(let e of n)for(let t of e)t.x+=r,t.y+=s;downscale(a=renderIntermediate(100,n),t)}function renderIntermediate(e,t){var n=document.createElement("canvas");n.width=e,n.height=e;var a=n.getContext("2d");a.fillRect(0,0,n.width,n.height);var o=2.5/INPUT_SIZE*e/2;a.strokeStyle="#FFFFFF",a.lineJoin="round",a.lineCap="round",a.lineWidth=o+o;for(let e of t){var r=0,s=0,i=!0;for(let t of e)i?(i=!1,a.moveTo(t.x,t.y)):a.moveTo(r,s),a.lineTo(t.x,t.y),r=t.x,s=t.y;a.closePath()}return a.stroke(),n}function bound(e,t,n=0){var a={x:e[0][0].x,y:e[0][0].y},o={x:e[0][0].x,y:e[0][0].y};for(let t of e)for(let e of t)a.x=Math.min(a.x,e.x),a.y=Math.min(a.y,e.y),o.x=Math.max(o.x,e.x),o.y=Math.max(o.y,e.y);a=Math.min(a.x,a.y),o=Math.max(o.x,o.y);var r=[];for(let l of e){var s=[];r.push(s);for(let e of l){var i={x:mapRange(e.x,a,o,n,t.x-n),y:mapRange(e.y,a,o,n,t.y-n)};s.push(i)}}return r}function mapRange(e,t,n,a,o){return a+(e-t)*(o-a)/(n-t)}function downscale(e,t){t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height)}function centerOfMass(e){var t={x:0,y:0},n=0,a=e.getContext("2d");data=a.getImageData(0,0,e.width,e.height).data;for(let a=0;a<data.length;a+=4){var o=data[a];o=Math.max(o,data[a+1]),o=Math.max(o,data[a+2]),o/=255,o*=data[a+3]/255;var r=a/4%e.width+.5,s=Math.floor(a/(4*e.width))+.5;n+=o,t.x+=r*o,t.y+=s*o}return t.x/=n,t.y/=n,t}function getInput(e){var t=e.getContext("2d"),n=[];n.length=INPUT_SIZE*INPUT_SIZE;for(var a=t.getImageData(0,0,INPUT_SIZE,INPUT_SIZE).data,o=0;o<n.length;o++)n[o]=a[4*o]/255;return n}function run(e,t){for(var n=feedforward(e,t),a=n[0],o=0,r=-1,s=1;s<n.length;s++)n[s]>a&&(a=n[s],r=o,o=s);return{firstGuessIndex:o,secondGuessIndex:r}}window.addEventListener("load",function(){for(var e=document.getElementsByClassName("digitsAI"),t=0;t<e.length;t++){var n=e[t],a=n.getElementsByClassName("digitInput")[0];resizeInput(a);var o=n.getElementsByClassName("digitClear")[0];o.innerText="clear";var r=n.getElementsByClassName("digitRaw")[0];r.width=INPUT_SIZE,r.height=INPUT_SIZE;var s=n.getElementsByClassName("digitGuess")[0],i=a.getContext("2d");i.strokeStyle="#FFFFFF",i.lineJoin="round",i.lineCap="round",i.lineWidth=20;var l=!1,d=[];function c(e,t,n){e.preventDefault(),l=!0,i.beginPath(),i.ellipse(t,n,0,0,0,0,Math.PI+Math.PI),i.closePath(),i.stroke(),i.moveTo(t,n),i.beginPath();var a=[];a.push({x:t,y:n}),d.push(a),normalize(d,r)}function h(e,t,n){(e.preventDefault(),l)&&(i.lineTo(t,n),i.moveTo(t,n),i.closePath(),i.stroke(),d[d.length-1].push({x:t,y:n}),normalize(d,r))}function u(e){if(l){l=!1;var t=getInput(r),n=run(network,t);s.innerText=n.firstGuessIndex}}function f(){i.fillRect(0,0,a.width,a.height),downscale(a,r),d.length=0,s.innerText=""}a.addEventListener("mousedown",function(e){c(e,e.pageX-this.offsetLeft,e.pageY-this.offsetTop)}),a.addEventListener("touchstart",function(e){c(e,e.targetTouches[0].pageX-this.offsetLeft,e.targetTouches[0].pageY-this.offsetTop)}),a.addEventListener("mousemove",function(e){h(e,e.pageX-this.offsetLeft,e.pageY-this.offsetTop)}),a.addEventListener("touchmove",function(e){h(e,e.targetTouches[0].pageX-this.offsetLeft,e.targetTouches[0].pageY-this.offsetTop)}),document.addEventListener("mouseup",u),document.addEventListener("touchend",u),f(),o.onclick=f}});const INPUT_LAYER=0,FIRST_SYNAPSES=1,PROCESSING_LAYER=2,SECOND_SYNAPSES=3,OUTPUT_LAYER=4;function feedforward(e,t){for(var n=0;n<t.length;n++)e[INPUT_LAYER][n]=t[n];for(n=0;n<e[PROCESSING_LAYER].length;n++)e[PROCESSING_LAYER][n]=0;var a=0;for(n=0;n<e[INPUT_LAYER].length;n++)for(var o=0;o<e[PROCESSING_LAYER].length;o++)e[PROCESSING_LAYER][o]+=e[INPUT_LAYER][n]*e[FIRST_SYNAPSES][a],a++;for(n=0;n<e[PROCESSING_LAYER].length;n++)e[PROCESSING_LAYER][n]=activation(e[PROCESSING_LAYER][n]);for(n=0;n<e[OUTPUT_LAYER].length;n++)e[OUTPUT_LAYER][n]=0;a=0;for(n=0;n<e[PROCESSING_LAYER].length;n++)for(o=0;o<e[OUTPUT_LAYER].length;o++)e[OUTPUT_LAYER][o]+=e[PROCESSING_LAYER][n]*e[SECOND_SYNAPSES][a],a++;for(n=0;n<e[OUTPUT_LAYER].length;n++)e[OUTPUT_LAYER][n]=activation(e[OUTPUT_LAYER][n]);return e[OUTPUT_LAYER]}function activation(e){return 1/(1+Math.exp(-e))}var network=[];function initializeNetwork(e){network.length=5,(network[0]=[]).length=784,(network[2]=[]).length=40,(network[4]=[]).length=10;var t=new Float32Array(e);network[1]=t.slice(0,31360),network[3]=t.slice(31360,62720)}function downloadNetwork(e){var t=new XMLHttpRequest;t.open("GET",e),t.responseType="arraybuffer",t.onload=function(){initializeNetwork(t.response)},t.send()}downloadNetwork("model/network.dat");var fadeElements,phraseIndex=0,phrases=["This should cycle through some dumb phrases.","Give me money please.","I make things.","Wow this website looks good!","I AM TOTALLY NOT A ROBOT.","Pretty good.","Do me a flavor and send an email my way.","You should give me a job.","I’m probably locked in my room playing with LEGO.","I don’t even see the code. All I see is blonde, brunette, redhead.","It’s a Unix system, I know this.","Did I mention that I would like a job?",":(){:|:&};:\ufeff","One job please!","Some days even my lucky rocket ship underpants don’t help.","Christopher Dombroccoli.","HTML is the best programming language.","People who put noses in smiley faces are heathens.",":-)","I build robots for fun.","Programmer Extraordinaire.","I'm pretty sure we're all in a simulation.","My favorite color is orange.","Have a nice day!","I just finished a jigsaw puzzle. The package said 5+ years but it only took me 2 months.","It's a doggy dog world out there.","I should have bought Bitcoin.","I use <i>coding</i> and <i>algorithms</i> to solve problems.","The language I like to use most when programming is profanity.","I'm probably showing this to you during an interview.","if ( !isWorking() ) { <br>&emsp;work();<br>}","Arrays should start at 2.",'"This shouldn\'t be working."'];function updateTicker(){var e=document.getElementById("ticker");if(e.parentElement.querySelector(":hover")!==e){e.className+="fade";var t=phrases[phraseIndex%phrases.length];phraseIndex++;var n=Math.floor(1e3*parseFloat(window.getComputedStyle(e).transitionDuration));setTimeout(function(){e.classList.remove("fade"),e.innerHTML=t},n)}}function setSlide(e,t){var n=e.getElementsByClassName("slide"),a=n[t=mod(t,n.length)];n[e.previous].style.display="",a.style.display="block";for(var o=e.getElementsByClassName("caption"),r=0;r<o.length;r++){o[r].innerHTML=a.dataset.caption}var s=e.getElementsByClassName("selectors");for(r=0;r<s.length;r++){var i=s[r].getElementsByClassName("selector");i[e.previous+1].classList.remove("selectorActive"),i[t+1].classList.add("selectorActive")}e.previous=t}function mod(e,t){return(e%t+t)%t}window.onload=function(){setInterval(updateTicker,3e3),fadeElements=document.getElementsByClassName("scrollfade")},window.onscroll=function(){if(fadeElements)for(var e=0;e<fadeElements.length;e++){var t=fadeElements[e],n=3*t.offsetHeight,a=(n-pageYOffset)/n;t.style.opacity=a<0?0:a>1?1:a*a}},window.addEventListener("load",function(){for(var e=document.getElementsByClassName("slideshow"),t=0;t<e.length;t++){var n=e[t];n.index=0,n.previous=0;var a=document.createElement("div");a.className+="selectors";var o=document.createElement("a");o.classList.toggle("prev"),o.classList.toggle("selector"),o.innerHTML="&#10094;",o.onclick=function(){var e=n;return function(){setSlide(e,--e.index)}}(),a.appendChild(o);for(var r=n.getElementsByClassName("slide").length,s=0;s<r;s++){var i=document.createElement("a");i.classList.toggle("selector"),i.index=s,i.innerText=s,i.onclick=function(){var e=n,t=s;return function(){e.index=t,setSlide(e,t)}}(),a.appendChild(i)}var l=document.createElement("a");l.classList.toggle("next"),l.classList.toggle("selector"),l.innerHTML="&#10095;",l.onclick=function(){var e=n;return function(){setSlide(e,++e.index)}}(),a.appendChild(l),n.appendChild(a);var d=document.createElement("div");d.classList.toggle("caption"),n.appendChild(d);(function(){var e=n})();setSlide(n,0)}var c=document.getElementsByTagName("img");for(t=0;t<c.length;t++){var h=c[t];h.dataset.src?u(h,function(e){e.style.filter="unset"}):h.style.filter="unset"}function u(e,t){var n=new Image,a=h.dataset.src;n.onload=function(){e.parent?e.parent.replaceChild(n,e):e.src=a,t&&t(e)},n.src=a}});